{% extends "base.html" %}
{% block content %}
<div class="neon-form-container" style="width:90%; max-width:800px; padding:20px;">
  <h2 class="center-text">{{ department | upper }} Admin Panel</h2>
  
  <div class="admin-actions" style="margin-bottom: 20px;">
    <div class="upload-section" style="margin-bottom:20px;">
      <h3 style="text-align:center; color:#00FFFF;">Upload Notice (Immediate)</h3>
      <form method="POST" action="{{ url_for('admin', dept=department) }}" enctype="multipart/form-data">
        <div class="neon-form-group">
          <input type="file" name="file" required>
        </div>
        <div class="neon-form-group">
          <input type="date" name="expire_date" placeholder="Expiration Date (optional)">
        </div>
        <input type="submit" value="Upload" class="neon-btn">
      </form>
    </div>
    <div class="upload-section" style="margin-bottom:20px; text-align:center;">
      <h3 style="color:#00FFFF;">Preschedule Notice</h3>
      <a href="{{ url_for('schedule_notice', dept=department) }}" class="neon-btn" style="padding:8px 16px; display:inline-block; width:auto;">Preschedule Notice</a>
    </div>
    <div class="upload-section" style="margin-bottom:20px; text-align:center;">
      <form method="POST" action="{{ url_for('delete_all_notices', dept=department) }}" onsubmit="return confirm('Are you sure you want to delete ALL notices for this department?');">
        <input type="submit" value="Delete All Notices" class="neon-btn" style="background-color:#DC3545; color:#fff;">
      </form>
    </div>
  </div>
  
  <!-- Notices sections remain as before. You can wrap the grids with neon containers if desired -->
  <div class="notices-section">
    <h3 class="center-text" style="color:#00FFFF;">Uploaded Immediate Notices</h3>
    <div class="notices-grid">
      {% for notice in immediate_notices %}
      <div class="notice-card">
        {% set file_url = url_for('uploaded_file', filename=notice[2]) %}
        {% if notice[3] in ['png', 'jpg', 'jpeg', 'gif', 'pdf_image'] %}
          <img src="{{ file_url }}" alt="Notice Image">
        {% elif notice[3] == 'mp4' %}
          <video src="{{ file_url }}" controls></video>
        {% elif notice[3] == 'mp3' %}
          <audio src="{{ file_url }}" controls></audio>
        {% else %}
          <a href="{{ file_url }}" target="_blank">View Document</a>
        {% endif %}
        <div class="notice-actions">
          {% if notice[0] is not none %}
          <a href="{{ url_for('delete_notice', notice_id=notice[0]) }}" class="neon-btn" style="background-color:#DC3545; color:#fff;"
             onclick="return confirm('Are you sure you want to delete this notice?');">
            Delete
          </a>
          {% else %}
          <span>Invalid ID</span>
          {% endif %}
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  
  <div class="notices-section">
    <h3 class="center-text" style="color:#00FFFF;">Prescheduled Notices</h3>
    <div class="notices-grid">
      {% for notice in prescheduled_notices %}
      <div class="notice-card">
        {% set file_url = url_for('uploaded_file', filename=notice[2]) %}
        {% if notice[3] in ['png', 'jpg', 'jpeg', 'gif', 'pdf_image'] %}
          <img src="{{ file_url }}" alt="Notice Image">
        {% elif notice[3] == 'mp4' %}
          <video src="{{ file_url }}" controls></video>
        {% elif notice[3] == 'mp3' %}
          <audio src="{{ file_url }}" controls></audio>
        {% else %}
          <a href="{{ url_for('uploaded_file', filename=notice[2]) }}" target="_blank">View Document</a>
        {% endif %}
        <div class="notice-actions">
          {% if notice[0] is not none %}
          <a href="{{ url_for('delete_notice', notice_id=notice[0]) }}" class="neon-btn" style="background-color:#DC3545; color:#fff;"
             onclick="return confirm('Are you sure you want to delete this notice?');">
            Delete
          </a>
          {% else %}
          <span>Invalid ID</span>
          {% endif %}
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  
  <div class="admin-nav" style="text-align:center; margin-top:20px;">
    <p><a href="{{ url_for('dashboard') }}" class="neon-secondary-btn">Back to Dashboard</a></p>
  </div>
</div>
{% endblock %}
