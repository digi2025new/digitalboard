{% extends "base.html" %}
{% set hide_nav = true %}
{% block content %}
<style>
  /* Dark Theme for Admin Panel */
  body {
    background-color: #1E1E1E;
    color: #FFFFFF;
  }

  .admin-container {
    width: 90%;
    max-width: 900px;
    margin: auto;
    padding: 20px;
    background: #2C2C2C;
    border-radius: 8px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
  }

  h2, h3 {
    color: #4A90E2;
    text-align: center;
  }

  .btn {
    display: inline-block;
    padding: 10px 20px;
    border-radius: 5px;
    text-align: center;
    color: #FFFFFF;
    font-weight: bold;
    border: none;
    cursor: pointer;
  }

  .btn-upload {
    background-color: #43A047;
  }

  .btn-upload:hover {
    background-color: #388E3C;
  }

  .btn-delete {
    background-color: #E53935;
  }

  .btn-delete:hover {
    background-color: #C62828;
  }

  .btn-primary {
    background-color: #2196F3;
  }

  .btn-primary:hover {
    background-color: #1976D2;
  }

  .notices-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
  }

  .notice-card {
    background: #333333;
    border: 2px solid #4A90E2;
    padding: 10px;
    border-radius: 6px;
    box-shadow: 2px 2px 8px rgba(255, 255, 255, 0.1);
    width: 280px;
    text-align: center;
  }

  .notice-card img, .notice-card video {
    max-width: 100%;
    border-radius: 4px;
  }
</style>

<div class="admin-container">
  <h2>{{ department | upper }} Admin Panel</h2>

  <!-- Upload Notice -->
  <div style="text-align: center; margin-bottom: 20px;">
    <h3>Upload Notice</h3>
    <form method="POST" action="{{ url_for('admin', dept=department) }}" enctype="multipart/form-data">
      <input type="file" name="file" required>
      <input type="date" name="expire_date" placeholder="Expiration Date (optional)">
      <input type="submit" value="Upload" class="btn btn-upload">
    </form>
  </div>

  <!-- Preschedule Notice -->
  <div style="text-align: center; margin-bottom: 20px;">
    <h3>Preschedule Notice</h3>
    <a href="{{ url_for('schedule_notice', dept=department) }}" class="btn btn-primary">Preschedule Notice</a>
  </div>

  <!-- Delete All Notices -->
  <div style="text-align: center; margin-bottom: 20px;">
    <form method="POST" action="{{ url_for('delete_all_notices', dept=department) }}" onsubmit="return confirm('Are you sure you want to delete ALL notices?');">
      <input type="submit" value="Delete All Notices" class="btn btn-delete">
    </form>
  </div>

  <!-- Display Immediate Notices -->
  <h3>Uploaded Notices</h3>
  <div class="notices-grid">
    {% for notice in immediate_notices %}
    <div class="notice-card">
      {% set file_url = url_for('uploaded_file', filename=notice[2]) %}
      {% if notice[3] in ['png', 'jpg', 'jpeg', 'gif', 'pdf_image'] %}
        <img src="{{ file_url }}" alt="Notice Image">
      {% elif notice[3] == 'mp4' %}
        <video src="{{ file_url }}" controls></video>
      {% elif notice[3] == 'mp3' %}
        <audio src="{{ file_url }}" controls></audio>
      {% else %}
        <a href="{{ file_url }}" target="_blank">View Document</a>
      {% endif %}
      <div style="margin-top: 10px;">
        <a href="{{ url_for('delete_notice', notice_id=notice[0]) }}" class="btn btn-delete" onclick="return confirm('Delete this notice?');">Delete</a>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Back to Dashboard -->
  <div style="text-align: center; margin-top: 20px;">
    <a href="{{ url_for('dashboard') }}" class="btn btn-primary">Back to Dashboard</a>
  </div>
</div>
{% endblock %}
