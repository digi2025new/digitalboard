{% extends "base.html" %}
{% block content %}
<div class="admin-panel-container" style="display: flex; align-items: center; justify-content: center; min-height: 80vh; padding: 10px; background: #23272A;">
  <div class="admin-panel" style="width: 90%; max-width: 800px; padding: 20px; background: #2C2F33; border-radius: 8px; box-shadow: 0 0 15px rgba(44, 177, 192, 0.4);">
    <h2 style="text-align: center; color: #9AB8D3;">{{ department | upper }} Admin Panel</h2>
    
    <!-- Immediate Notice Upload -->
    <div class="admin-section" style="margin-bottom: 20px;">
      <h3 style="text-align: center; color: #9AB8D3;">Upload Notice (Immediate)</h3>
      <form method="POST" action="{{ url_for('admin', dept=department) }}" enctype="multipart/form-data">
        <div class="form-group" style="margin-bottom: 10px;">
          <input type="file" name="file" required style="width: 100%; padding: 8px; background: #2C2F33; color: #D1D1D1; border: 1px solid #9AB8D3; border-radius: 4px;">
        </div>
        <div class="form-group" style="margin-bottom: 10px;">
          <input type="date" name="expire_date" placeholder="Expiration Date (optional)" style="width: 100%; padding: 8px; background: #2C2F33; color: #D1D1D1; border: 1px solid #9AB8D3; border-radius: 4px;">
        </div>
        <input type="submit" value="Upload" class="btn" style="width: 100%; padding: 10px; background-color: #2CB1C0; color: #23272A; border: none; border-radius: 4px; font-size: 1rem; cursor: pointer; transition: background-color 0.3s, transform 0.3s; margin-top: 10px;">
      </form>
    </div>

    <!-- Preschedule Notice -->
    <div class="admin-section" style="margin-bottom: 20px; text-align: center;">
      <h3 style="color: #9AB8D3;">Preschedule Notice</h3>
      <a href="{{ url_for('schedule_notice', dept=department) }}" class="btn" style="display: inline-block; padding: 10px 20px; background-color: #2CB1C0; color: #23272A; border: none; border-radius: 4px; font-size: 1rem; cursor: pointer; transition: background-color 0.3s, transform 0.3s;">Preschedule Notice</a>
    </div>

    <!-- Delete All Notices -->
    <div class="admin-section" style="margin-bottom: 20px; text-align: center;">
      <form method="POST" action="{{ url_for('delete_all_notices', dept=department) }}" onsubmit="return confirm('Are you sure you want to delete ALL notices for this department?');">
        <input type="submit" value="Delete All Notices" class="btn" style="display: inline-block; padding: 10px 20px; background-color: #8B1E1E; color: #fff; border: none; border-radius: 4px; font-size: 1rem; cursor: pointer; transition: background-color 0.3s, transform 0.3s;">
      </form>
    </div>

    <!-- Uploaded Immediate Notices -->
    <div class="admin-section" style="margin-bottom: 20px; text-align: center;">
      <h3 style="color: #9AB8D3;">Uploaded Immediate Notices</h3>
      <div class="notices-grid" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
        {% for notice in immediate_notices %}
        <div class="notice-card" style="flex: 1 1 300px; max-width: 300px; background: #2C2F33; padding: 10px; border: 1px solid #9AB8D3; border-radius: 4px; box-shadow: 0 0 8px rgba(44, 177, 192, 0.4);">
          {% set file_url = url_for('uploaded_file', filename=notice[2]) %}
          {% if notice[3] in ['png', 'jpg', 'jpeg', 'gif', 'pdf_image'] %}
            <img src="{{ file_url }}" alt="Notice Image" style="width: 100%; height: auto; border-radius: 4px;">
          {% elif notice[3] == 'mp4' %}
            <video src="{{ file_url }}" controls style="width: 100%; height: auto; border-radius: 4px;"></video>
          {% elif notice[3] == 'mp3' %}
            <audio src="{{ file_url }}" controls style="width: 100%;"></audio>
          {% else %}
            <a href="{{ file_url }}" target="_blank" style="color: #2CB1C0;">View Document</a>
          {% endif %}
          <div class="notice-actions" style="text-align: center; margin-top: 10px;">
            {% if notice[0] is not none %}
            <a href="{{ url_for('delete_notice', notice_id=notice[0]) }}" class="btn" style="display: inline-block; padding: 8px 16px; background-color: #A33E3E; color: #fff; border: none; border-radius: 4px; font-size: 0.9rem; cursor: pointer; transition: background-color 0.3s, transform 0.3s;" onclick="return confirm('Are you sure you want to delete this notice?');">Delete</a>
            {% else %}
            <span style="color: #D1D1D1;">Invalid ID</span>
            {% endif %}
          </div>
        </div>
        {% endfor %}
      </div>
    </div>

    <!-- Prescheduled Notices -->
    <div class="admin-section" style="margin-bottom: 20px; text-align: center;">
      <h3 style="color: #9AB8D3;">Prescheduled Notices</h3>
      <div class="notices-grid" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
        {% for notice in prescheduled_notices %}
        <div class="notice-card" style="flex: 1 1 300px; max-width: 300px; background: #2C2F33; padding: 10px; border: 1px solid #9AB8D3; border-radius: 4px; box-shadow: 0 0 8px rgba(44, 177, 192, 0.4);">
          {% set file_url = url_for('uploaded_file', filename=notice[2]) %}
          {% if notice[3] in ['png', 'jpg', 'jpeg', 'gif', 'pdf_image'] %}
            <img src="{{ file_url }}" alt="Notice Image" style="width: 100%; height: auto; border-radius: 4px;">
          {% elif notice[3] == 'mp4' %}
            <video src="{{ file_url }}" controls style="width: 100%; height: auto; border-radius: 4px;"></video>
          {% elif notice[3] == 'mp3' %}
            <audio src="{{ file_url }}" controls style="width: 100%;"></audio>
          {% else %}
            <a href="{{ file_url }}" target="_blank" style="color: #2CB1C0;">View Document</a>
          {% endif %}
          <div class="notice-actions" style="text-align: center; margin-top: 10px;">
            {% if notice[0] is not none %}
            <a href="{{ url_for('delete_notice', notice_id=notice[0]) }}" class="btn" style="display: inline-block; padding: 8px 16px; background-color: #A33E3E; color: #fff; border: none; border-radius: 4px; font-size: 0.9rem; cursor: pointer; transition: background-color 0.3s, transform 0.3s;" onclick="return confirm('Are you sure you want to delete this notice?');">Delete</a>
            {% else %}
            <span style="color: #D1D1D1;">Invalid ID</span>
            {% endif %}
          </div>
        </div>
        {% endfor %}
      </div>
    </div>

    <!-- Admin Navigation -->
    <div class="admin-nav" style="text-align: center; margin-top: 20px;">
      <a href="{{ url_for('dashboard') }}" class="btn" style="display: inline-block; width: auto; padding: 10px 20px; background-color: #2CB1C0; color: #23272A; border: none; border-radius: 4px; font-size: 1rem; cursor: pointer; transition: background-color 0.3s, transform 0.3s;">Back to Dashboard</a>
    </div>
  </div>
</div>
{% endblock %}
